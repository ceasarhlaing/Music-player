let albums = [
    {
        id: 'album_1',
        name: 'Map of the Soul: 7',
        singer: 'BTS',
        cover: './assets/audios/BTS/cover.jpg',
        songs: [
            {
                id: 'justin_01',
                name: 'Boy with luv',
                singer: 'BTS',
                path: './assets/audios/BTS/Boywithluv.mp3',
                cover: './assets/audios/BTS/boywithluv.jpg'
            },
            {
                id: 'justin_02',
                name: 'ON',
                singer: 'BTS',
                path: './assets/audios/BTS/on.mp3',
                cover: './assets/audios/BTS/on.jpg'
            },
            {
                id: 'justin_03',
                name: 'Black Swan',
                singer: 'BTS',
                path: './assets/audios/BTS/blackswan.mp3',
                cover: './assets/audios/BTS/blackswan.jpg'
            },
            {
                id: 'justin_04',
                name: 'Make it Right',
                singer: 'BTS (feat. Lauv)',
                path: './assets/audios/BTS/makeitright.mp3',
                cover: './assets/audios/BTS/makeitright.jpg'
            },
			{
                id: 'justin_05',
                name: '00:00 (Zero O-Clock)',
                singer: 'Jin, Jimin, V, JK',
                path: './assets/audios/BTS/00.mp3',
                cover: './assets/audios/BTS/00.jpg'
            },
			{
                id: 'justin_06',
                name: 'Inner Child',
                singer: 'V',
                path: './assets/audios/BTS/child.mp3',
                cover: './assets/audios/BTS/child.jpg'
            }
        ]
    },
    {
         id: 'album_2',
        name: 'TWICE TWICELAND - THE OPENING [ENCORE]',
        singer: 'Twice',
        cover: './assets/audios/Twice/yory.jpg',
        songs: [
            {
                id: 'one_01',
                name: 'Like a Fool',
                singer: 'Twice',
                path: './assets/audios/Twice/fool.m4a',
                cover: './assets/audios/Twice/fool.jpg'
            },
            {
                id: 'one_02',
                name: 'TT',
                singer: 'Twice',
                path: './assets/audios/Twice/tt.m4a',
                cover: './assets/audios/Twice/tt.jpg'
            },
			{
                id: 'one_03',
                name: '1 To 10',
                singer: 'Twice',
                path: './assets/audios/Twice/110.m4a',
                cover: './assets/audios/Twice/110.webp'
            },
			{
                id: 'one_04',
                name: 'Cheer Up',
                singer: 'Twice',
                path: './assets/audios/Twice/cheer.m4a',
                cover: './assets/audios/Twice/cheer.jpg'
            },
			{
                id: 'one_05',
                name: 'Someone Like Me',
                singer: 'Twice',
                path: './assets/audios/Twice/slm.m4a',
                cover: './assets/audios/Twice/slm.jpg'
            },
			{
                id: 'one_06',
                name: 'One In A Million',
                singer: 'Twice',
                path: './assets/audios/Twice/million.m4a',
                cover: './assets/audios/Twice/million.jpg'
            },
			{
                id: 'one_07',
                name: 'Signal',
                singer: 'Twice',
                path: './assets/audios/Twice/signal.m4a',
                cover: './assets/audios/Twice/signal.jpg'
            },
			{
                id: 'one_08',
                name: 'Knock Knock',
                singer: 'Twice',
                path: './assets/audios/Twice/kk.m4a',
                cover: './assets/audios/Twice/kk.webp'
            }
        ]
    },
    {
        
             id: 'album_3',
        name: "Born Pink",
        singer: 'Black Pink',
        cover: './assets/audios/BlickPink/bp.jpg',
        songs: [
            {
                id: 'charlie_01',
                name: 'Tally',
                singer: 'Black Pink',
                path: './assets/audios/BlackPink/tally.m4a',
                cover: './assets/audios/BlackPink/tally.jpg'
            },
            {
                id: 'charlie_02',
                name: 'Shut Down',
                singer: 'Black Pink',
                path: './assets/audios/BlackPink/shutdown.m4a',
                cover: './assets/audios/BlackPink/shutdown.png'
            },
			{
                id: 'charlie_03',
                name: 'Hard to Love',
                singer: 'Rose',
                path: './assets/audios/BlackPink/htl.m4a',
                cover: './assets/audios/BlackPink/htl.jpeg'
            },
			{
                id: 'charlie_04',
                name: 'Pink Vernom',
                singer: 'Black Pink',
                path: './assets/audios/BlackPink/pinkvernom.m4a',
                cover: './assets/audios/BlackPink/pinkvernom.jpg'
            },
			{
                id: 'charlie_05',
                name: 'Yeah Yeah Yeah',
                singer: 'Black Pink',
                path: './assets/audios/BlackPink/yyy.m4a',
                cover: './assets/audios/BlackPink/yyy.jpg'
            },
			
			{
                id: 'charlie_06',
                name: 'Ready For Love',
                singer: 'Black Pink',
                path: './assets/audios/BlackPink/rfl.m4a',
                cover: './assets/audios/BlackPink/rfl.jpg'
            },
			
			{
                id: 'charlie_07',
                name: 'Typa girl',
                singer: 'Black Pink',
                path: './assets/audios/BlackPink/typagirl.m4a',
                cover: './assets/audios/BlackPink/typagirl.jpg'
            },
			{
                id: 'charlie_08',
                name: 'The Happiest girl',
                singer: 'Black Pink',
                path: './assets/audios/BlackPink/thg.m4a',
                cover: './assets/audios/BlackPink/thg.jpg'
            }
			
        ]
        
    },

        {
        id: 'album_4',
        name: 'Best Songs Of Justin Bieber',
        singer: 'Justin Bieber',
        cover: './assets/audios/justin_bieber/jb.jpg',
        songs: [
            {
                id: 'justin_01',
                name: 'Anyone',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/anyone.mp3',
                cover: './assets/audios/justin_bieber/anyone.webp'
            },
            {
                id: 'justin_02',
                name: 'Ghost',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/ghost.mp3',
                cover: './assets/audios/justin_bieber/ghost.webp'
            },
            {
                id: 'justin_03',
                name: 'Lonely',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/lonely.mp3',
                cover: './assets/audios/justin_bieber/lonely.webp'
            },
            {
                id: 'justin_04',
                name: 'Baby',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/baby.mp3',
                cover: './assets/audios/justin_bieber/baby.webp'
            },
			
            {    id: 'justin_05',
                name: 'Love Me',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/loveme.m4a',
                cover: './assets/audios/justin_bieber/loveme.jpg'
            },
			
            {   id: 'justin_06',
                name: 'Eeenie Meenie',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/em.m4a',
                cover: './assets/audios/justin_bieber/em.jpg'
            },
			
			{  id: 'justin_07',
                name: 'That Should Be Me',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/should.m4a',
                cover: './assets/audios/justin_bieber/should.jpg'
            },
			
			{   id: 'justin_08',
                name: 'Yummy',
                singer: 'Justin Bieber',
                path: './assets/audios/justin_bieber/yummy.m4a',
                cover: './assets/audios/justin_bieber/yummy.jpg'
            }
        ]
    },
    {
        id: 'album_5',
        name: 'One Direction Greatest Hits',
        singer: 'One Direction',
        cover: './assets/audios/one_direction/one.jog',
        songs: [
            {
                id: 'one_01',
                name: 'Story Of My Life',
                singer: 'One Direction',
                path: './assets/audios/one_direction/storyofmylife.mp3',
                cover: './assets/audios/one_direction/storyofmylife.webp'
            },
            {
                id: 'one_02',
                name: 'You And I',
                singer: 'One Direction',
                path: './assets/audios/one_direction/youandi.mp3',
                cover: './assets/audios/one_direction/youandi.webp'
            },
		{
                id: 'one_03',
                name: 'Eighteen',
                singer: 'One Direction',
                path: './assets/audios/one_direction/18.m4a',
                cover: './assets/audios/one_direction/18.jpg'
            },	
			{
                id: 'one_04',
                name: 'Strong',
                singer: 'One Direction',
                path: './assets/audios/one_direction/strong.m4a',
                cover: './assets/audios/one_direction/strong.jpg'
            },
			{
                id: 'one_05',
                name: 'Right Now',
                singer: 'One Direction',
                path: './assets/audios/one_direction/rn.m4a',
                cover: './assets/audios/one_direction/rn.jpg'
            },
			{
                id: 'one_06',
                name: 'They do not know about us',
                singer: 'One Direction',
                path: './assets/audios/one_direction/know.m4a',
                cover: './assets/audios/one_direction/know.jpg'
            },
			{
                id: 'one_07',
                name: 'One Thing',
                singer: 'One Direction',
                path: './assets/audios/one_direction/ot.m4a',
                cover: './assets/audios/one_direction/ot.png'
            },
			{
                id: 'one_08',
                name: 'Night Changes',
                singer: 'One Direction',
                path: './assets/audios/one_direction/nc.m4a',
                cover: './assets/audios/one_direction/nc.jpg'
            }
        ]
    },
    {
        id: 'album_6',
        name: "Seventeen Popular Songs",
        singer: 'Seventeen',
        cover: './assets/audios/svt/svt.jpg',
        songs: [
            {
                id: 'charlie_01',
                name: 'Clap',
                singer: 'Seventeen',
                path: './assets/audios/svt/clap.m4a',
                cover: './assets/audios/svt/clap.webp'
            },
            {
                id: 'charlie_02',
                name: 'Super',
                singer: 'Seventeen',
                path: './assets/audios/svt/super.m4a',
                cover: './assets/audios/svt/super.png'
            },
			{
                id: 'charlie_03',
                name: 'Pretty U',
                singer: 'Seventeen',
                path: './assets/audios/svt/pu.m4a',
                cover: './assets/audios/svt/pu.jpg'
            },
			{
                id: 'charlie_04',
                name: 'Home',
                singer: 'Seventeen',
                path: './assets/audios/svt/home.m4a',
                cover: './assets/audios/svt/home.jpg'
            },
			{
                id: 'charlie_05',
                name: 'Hot',
                singer: 'Seventeen',
                path: './assets/audios/svt/hot.m4a',
                cover: './assets/audios/svt/hot.jpg'
            },
			{
                id: 'charlie_06',
                name: 'Very Nice',
                singer: 'Seventeen',
                path: './assets/audios/svt/vn.m4a',
                cover: './assets/audios/svt/vn.jpg'
            },
			{
                id: 'charlie_07',
                name: 'Do not wanna cry',
                singer: 'Seventeen',
                path: './assets/audios/svt/dwc.m4a',
                cover: './assets/audios/svt/dwc.png'
            },
			{
                id: 'charlie_08',
                name: 'Darling',
                singer: 'Seventeen',
                path: './assets/audios/svt/d.m4a',
                cover: './assets/audios/svt/darling.jpg'
            }
        ]
    },
	    	
	{
          id: 'album_7',
        name: 'Taylor Swift Popular Songs',
        singer: 'Taylor Swift',
        cover: './assets/audios/Ts/taylor.jpg',
        songs: [
            {
                id: 'one_01',
                name: 'Lover',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/lover.m4a',
                cover: './assets/audios/Ts/lover.jpg'
            },
            {
                id: 'one_02',
                name: 'You Belong With Me',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/ubwe.m4a',
                cover: './assets/audios/Ts/ubwe.jpg'
            },
			{
                id: 'one_03',
                name: 'Enchanted',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/en.m4a',
                cover: './assets/audios/Ts/en.jpg'
            },
			{
                id: 'one_04',
                name: 'Love Story',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/ls.m4a',
                cover: './assets/audios/Ts/ls.jpg'
            },
			{
                id: 'one_05',
                name: 'Look what you make me do',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/lwymmd.m4a',
                cover: './assets/audios/Ts/lwymmd.jpg'
            },
			{
                id: 'one_06',
                name: 'August',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/8.m4a',
                cover: './assets/audios/Ts/8.jpg'
            },
			{
                id: 'one_07',
                name: 'Blank Space',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/bs.m4a',
                cover: './assets/audios/Ts/bs.jpg'
            },
			{
                id: 'one_08',
                name: 'Anti-Hero',
                singer: 'Taylor Swift',
                path: './assets/audios/Ts/ah.m4a',
                cover: './assets/audios/Ts/ah.jpg'
            },
			
        ]
    },
	{
          id: 'album_8',
        name: 'Enhypen Popular Songs',
        singer: 'Enhypen',
        cover: './assets/audios/en/en.jpg',
        songs: [
            {
                id: 'one_01',
                name: 'Drunk-Dazed',
                singer: 'Enhypen',
                path: './assets/audios/en/dd.m4a',
                cover: './assets/audios/en/dd.jpg'
            },
            {
                id: 'one_02',
                name: 'Hey Tayo',
                singer: 'Enhypen',
                path: './assets/audios/en/tayo.m4a',
                cover: './assets/audios/en/tayo.jpg'
            },
			{
                id: 'one_03',
                name: 'Blockbuster',
                singer: 'Enhypen feat:YeonJun',
                path: './assets/audios/en/bb.m4a',
                cover: './assets/audios/en/bb.jpg'
            },
			{
                id: 'one_04',
                name: 'Polaroid Love',
                singer: 'Enhypen',
                path: './assets/audios/en/pl.m4a',
                cover: './assets/audios/en/pl.jpg'
            },
			{
                id: 'one_05',
                name: 'Future Perfect',
                singer: 'Enhypen',
                path: './assets/audios/en/fp.m4a',
                cover: './assets/audios/en/fp.jpg'
            },
			{
                id: 'one_06',
                name: 'Parado XXX Invasion',
                singer: 'Enhypen',
                path: './assets/audios/en/px.m4a',
                cover: './assets/audios/en/px.jpg'
            },
			{
                id: 'one_07',
                name: 'Bite Me',
                singer: 'Enhypen',
                path: './assets/audios/en/bm.m4a',
                cover: './assets/audios/en/bm.jpg'
            },
			{
                id: 'one_08',
                name: 'Shout Out',
                singer: 'Enhypen',
                path: './assets/audios/en/so.m4a',
                cover: './assets/audios/en/so.jpg'
            },
			
        ]
    },
];



const currentSongAudioTag = document.getElementById('current-song')
const currentContentTag = document.getElementById('current-content')
const playAndPauseTag = document.getElementById('play-pause')
const previousTag = document.getElementById('previous')
const nextTag = document.getElementById('next')
const currentAndTotalTimeTag = document.getElementById('currentAndTotalTime')
const currentProgressTag = document.getElementById('currentProgress')


// ------------------ ||||||| ----------------------

// import albums  from './albums.js';

const volumeIncreaseTag = document.getElementById('volume-increase')
const volumeDecreaseTag = document.getElementById('volume-decrease')
const albumListTag = document.getElementById('song-list')
const volumePercent = document.getElementById('volume-percent')
const favoriateActionTag = document.getElementById('favoriate-action')

let songs = [];
let currentPlayingIndex = 0

const initialFun = () => {
    const queryParameters = window.location.search;
    if(!queryParameters){
        window.location.href = 'index.html';
        return
    }
    // queryParameters.split('=')[1] => album_2&song_id | queryParameters.split('=')[1].split('&')[0] => album_2
    const album_id = queryParameters.split('=')[1].split('&')[0];
    const song_id = queryParameters.split('=')[2]
    const album = albums.find(album => album.id === album_id)
    if(!album) {
        window.location.href = 'index.html';
        return
    }
    songs = album.songs
    let index = 0;
    if(song_id) {
        const indexOfselectedSong = songs.findIndex(song => song.id === song_id)
        index = indexOfselectedSong ? indexOfselectedSong : 0
    }
    currentPlayingIndex = index
    setCurrentSong(index)
    {/* 
    <li class="song">
        <div>
            <img src="./assets/audios/justin_bieber/hero.webp" alt="">
            <div class='conver-content'>
                <div class="song_name">Best Songs Of Justin Bieber 2020</div>
                <div class="song_singer">Justin Bieber</div>
            </div>
        </div>
    </li> 
    */}

    for (let i = 0; i < songs.length; i++) {
        const liTag = document.createElement('li')
        liTag.classList.add('song')

        // Favoriate
        const favoriateTag = document.createElement('span')
        favoriateTag.classList.add('favoriate')
        favoriateTag.id = songs[i].id + '-favoriate'

        const coverAndContentTag = document.createElement('div')
        coverAndContentTag.classList.add('conver-content')
    
        const imgTag = document.createElement('img')
        imgTag.src = songs[i].cover
    
        const contentTag = document.createElement('div')
        contentTag.classList.add('content')
    
        const nameTag = document.createElement('div')
        nameTag.classList.add('song_name')
        nameTag.textContent = songs[i].name
    
        const singerTag = document.createElement('div')
        singerTag.classList.add('song_singer')
        singerTag.textContent = songs[i].singer

        //recent
        const recentTag = document.createElement('div')
        recentTag.classList.add('recent')
        recentTag.id = songs[i].id + '-recent'
        recentTag.textContent = ''
    
        contentTag.append(nameTag, singerTag)
        coverAndContentTag.append(imgTag, contentTag)
    
        liTag.append(coverAndContentTag, recentTag, favoriateTag)
    
        albumListTag.append(liTag)
    
    
        liTag.addEventListener('click', playSong.bind(null, i))
    }
}

const setCurrentSong = (index) => {
    playAndPauseTag.innerHTML = `
        <i class="fa-solid fa-circle-pause"></i>
    `;
    currentSongAudioTag.src = songs[index].path
    currentSongAudioTag.play()
    currentContentTag.innerHTML = `
        <p class="name">${songs[index].name}</p>
        <p class="singer">${songs[index].singer}</p>
    `;
}

const playSong = (index) => {
    const recentTag = document.getElementById(songs[index].id + '-recent')
    recentTag.textContent = 'Recent'
    setCurrentSong(index)
    currentPlayingIndex = index
}

initialFun()

// Play or Pause
playAndPauseTag.addEventListener('click', (event) => {
    if(currentSongAudioTag.duration > 0 && !currentSongAudioTag.paused) {
        currentSongAudioTag.pause()
        playAndPauseTag.innerHTML = `
        <i class="fa-solid fa-circle-play"></i>
        `;
    }else {
        currentSongAudioTag.play()
        playAndPauseTag.innerHTML = `
        <i class="fa-solid fa-circle-pause"></i>
        `;
    }
})

// Next 
nextTag.addEventListener('click', (event) => {
    if(currentPlayingIndex === songs.length - 1) {
        currentPlayingIndex = -1
    }
    setCurrentSong(currentPlayingIndex + 1)
    const recentTag = document.getElementById(songs[currentPlayingIndex + 1].id + '-recent')
    recentTag.textContent = 'Recent'
    currentPlayingIndex ++
})

// Previous
previousTag.addEventListener('click', (event) => {
    if(currentPlayingIndex === 0) {
        currentPlayingIndex = songs.length
    }
    setCurrentSong(currentPlayingIndex - 1)
    const recentTag = document.getElementById(songs[currentPlayingIndex - 1].id + '-recent')
    recentTag.textContent = 'Recent'
    currentPlayingIndex --
})


const createTimeText = (totalSeconds) => {
    const minutes = Math.floor(totalSeconds / 60) 
    const seconds = totalSeconds % 60 

    const minuteText = minutes < 10 ? "0" + minutes.toString() : minutes
    const secondText = seconds < 10 ? "0" + seconds.toString() : seconds
    return minuteText + ":" + secondText;
}

let duration = 0
let durationTime = "00:00"
currentSongAudioTag.addEventListener('loadeddata', (event) => {
    duration = Math.floor(currentSongAudioTag.duration)
    durationTime = createTimeText(duration)
    currentAndTotalTimeTag.textContent = "00:00" + " / " + durationTime

})

currentSongAudioTag.addEventListener('timeupdate', (event) => {
    // When current playing song is finished, play next song automatically.
    if(currentSongAudioTag.duration === currentSongAudioTag.currentTime) { 
        if(currentPlayingIndex === songs.length - 1) {
            currentPlayingIndex = -1
        }
    
        playAndPauseTag.innerHTML = `
            <i class="fa-solid fa-circle-pause"></i>
        `;
        currentSongAudioTag.src = songs[currentPlayingIndex + 1].path
        currentSongAudioTag.play()
        currentContentTag.innerHTML = `
            <p class="name">${songs[currentPlayingIndex + 1].name}</p>
            <p class="singer">${songs[currentPlayingIndex + 1].singer}</p>
        `;
        currentPlayingIndex ++
    }

    // For progress bar
    const currentTime = Math.floor(currentSongAudioTag.currentTime)
    const currentTimeText = createTimeText(currentTime)
    const currentTimeTextAnddurationTimeText = currentTimeText + " / " + durationTime

    currentAndTotalTimeTag.textContent = currentTimeTextAnddurationTimeText

    updateCurrentProgress(currentTime)
})

const updateCurrentProgress = (currentTime) => {
    const currentProgressWidth = (280 / duration) * currentTime
    currentProgressTag.style.width = currentProgressWidth.toString() + "px" 
}


// Audio Volume Increase And Decrease

let song_volume = 100;
volumeIncreaseTag.addEventListener('click', () => {
    if (currentSongAudioTag.volume < 1.0) {
        currentSongAudioTag.volume += 0.1
        song_volume += 10
        volumePercent.textContent = song_volume + '%'
    }
})

volumeDecreaseTag.addEventListener('click', () => {
    console.log(currentSongAudioTag.volume)
    if (currentSongAudioTag.volume > 0.1) {
        currentSongAudioTag.volume -= 0.1
        song_volume -= 10
        volumePercent.textContent = song_volume + '%'
    }
})  


//  Favoriate
favoriateActionTag.addEventListener('click', () => {
    // const favTag = document.createElement('i')
    // favTag.classList.add('fa-solid' ,'fa-heart', 'favoriate')

    const favoriateTag = document.getElementById(songs[currentPlayingIndex].id + '-favoriate')
    favoriateTag.innerHTML = `<i class="fa-solid fa-heart"></i>`;
})